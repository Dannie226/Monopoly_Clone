import*as e from"three";import{GLTFLoader as t}from"three/examples/jsm/loaders/GLTFLoader";import{RGBELoader as o}from"three/examples/jsm/loaders/RGBELoader";import*as a from"../libs/tween";import{GUI as r}from"dat.gui";import{Player as n}from"./logic/Player";import{Globals as i}from"./logic/Globals";import{Dice as s}from"./logic/Dice";const{innerWidth:l,innerHeight:d}=window,m=new e.WebGLRenderer,c=(m.setSize(l,d),m.setClearColor(12571109),document.body.appendChild(m.domElement),new e.Scene),_=new e.PerspectiveCamera(75,l/d,100,3e3),u=(_.position.y=1e3,_.position.x=2e3,i.camera=_,new e.DirectionalLight),b=(c.add(u),new e.PMREMGenerator(m)),h=new e.LoadingManager,p=new t(h),g={tokens:{hat:null,iron:null,barrow:null,thimble:null},board:null},f=new r,w=(p.load("../die.glb",e=>{s.init();const t=e.scene.getObjectByName("Box001_Material_#25_0");t.geometry.center(),c.add(s.createDie(t).getMesh()),c.add(s.createDie().getMesh())}),p.load("../board.glb",e=>{const t=[];for(const o of["Top_Hat_09_-_Default_0","Iron_09_-_Default_0","Wheel_Barrow_09_-_Default_0","Thimble_09_-_Default_0"]){const a=e.scene.getObjectByName(o);a.geometry.rotateX(-Math.PI/2),a.geometry.rotateY(Math.PI/2),c.add(a),t.push(a)}g.tokens.hat=t[0],g.tokens.iron=t[1],g.tokens.barrow=t[2],g.tokens.thimble=t[3],g.tokens.barrow.visible=g.tokens.thimble.visible=!1,_.position.set(0,975,0),_.quaternion.set(-Math.SQRT1_2,0,0,Math.SQRT1_2),g.board=e.scene.getObjectByName("Board_01_-_Default_0"),g.board.geometry.rotateX(-Math.PI/2),g.board.position.z=-10,c.add(g.board)}),h.onLoad=async function(){const e=new n(null,"Daniel",g.tokens.iron);await e.moveForward(7)},new o);function y(){a.update(),s.update(),m.render(c,_),requestAnimationFrame(y)}w.load("https://threejs.org/examples/textures/equirectangular/pedestrian_overpass_1k.hdr",function(e){c.environment=b.fromEquirectangular(e).texture}),y();